#!/usr/bin/env sh

# If not running interactively, don't do anything
case $- in
    *i*) stty -ixon
        ;;
      *) return
          ;;
esac

exists() {
    command -v "$1" > /dev/null 2>&1
}

safesource() {
    [ -r "$1" ] && . "$1"
}

# [ -x /usr/bin/lesspipe ] && eval "$(SHELL=/bin/sh lesspipe)"
if [ $(hostname) = "garry" ]; then
    safesource /usr/share/git/completion/git-prompt.sh
else
    safesource /usr/lib/git-core/git-sh-prompt
fi
export GIT_PS1_SHOWDIRTYSTATE=1
export GIT_PS1_SHOWSTASHSTATE=1
export GIT_PS1_SHOWUNTRACKEDFILES=1
export GIT_PS1_SHOWUPSTREAM="auto"

PS1="\[\033[38;1;32m\]\u\[$(tput sgr0)\]\[\033[38;1;37m\]@\[$(tput sgr0)\]\[\033[38;1;36m\]\h\[$(tput sgr0)\]\[\033[38;1;37m\]:\[$(tput sgr0)\]\[\033[38;0;33m\]\w\[$(tput sgr0)\]$(__git_ps1 " (%s)")[\[\033[38;0;31m\]\$?\[$(tput sgr0)\]]\$ "
export PS1

safesource ~/.env

safesource ~/.aliases

# numlock
tput smkx

if [ -z "$TMUX" ] && [ -n "$SSH_TTY" ]; then
    exists tmux && exec tmux new-session -A -s ssh
fi
